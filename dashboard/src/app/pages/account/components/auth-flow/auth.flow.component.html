<div class="auth-page">
  <app-motion-background></app-motion-background>

  <div class="hero">
    <mat-icon class="logo" svgIcon="logo"></mat-icon>
    <h1 class="welcome">
      @if (authMode() === "register") {
        <span class="line-1">Join the MotionAds</span>
        <span class="line-2">Driver Team</span>
      } @else {
        <span class="line-1">Welcome Back to the</span>
        <span class="line-2">MotionAds Driver Team</span>
      }
    </h1>
    <p class="byline">
      @if (authMode() !== "register") {
        Please enter your details below to<br />sign into your driver account
      }
    </p>
  </div>

  @if (authMode() === "login") {
    <form
      class="form-card auth-form"
      (submit)="onSubmit(); $event.preventDefault()"
    >
      <mat-form-field appearance="outline" class="field">
        <mat-label>Email Address</mat-label>
        <input
          matInput
          [field]="loginForm.email"
          placeholder="enter your email address.."
          aria-required="true"
        />
      </mat-form-field>
      <mat-form-field appearance="outline" class="field">
        <mat-label>Password</mat-label>
        <input
          matInput
          [field]="loginForm.password"
          type="password"
          placeholder="enter your password.."
          aria-required="true"
          #passwordInput
        />
        <button
          mat-icon-button
          matSuffix
          type="button"
          (click)="togglePasswordVisibility($event, passwordInput)"
          [attr.aria-label]="hide() ? 'Show password' : 'Hide password'"
        >
          <mat-icon>{{ hide() ? "visibility_off" : "visibility" }}</mat-icon>
        </button>
      </mat-form-field>
      <div class="actions">
        <button type="button" class="link" (click)="requestPasswordReset()">
          Forgot Password?
        </button>
      </div>
      <button
        mat-flat-button
        color="primary"
        class="submit"
        type="submit"
        [disabled]="loginForm().invalid()"
      >
        SIGN IN
      </button>
      @if (resetPasswordMessage()) {
        <p class="status" [class.error]="isError()">
          {{ resetPasswordMessage() }}
        </p>
      }
      <p class="legal">
        By continuing you agree to our
        <a [routerLink]="termsRoute">Terms of Service</a> and
        <a [routerLink]="privacyRoute">Privacy Policy</a>.
      </p>
    </form>

    <div class="signup-cta">
      <button class="signup-image-button" (click)="switchMode('register')">
        <img
          src="assets/images/sign_up.png"
          alt="Sign up to become a MotionAds Driver"
          class="signup-image"
        />
      </button>
    </div>
  } @else {
    <!-- Register info banner (image) -->
    <div class="register-info" aria-hidden="false">
      <img
        [routerLink]="moreInformationRoute"
        src="assets/images/register_bike.png"
        alt="Discover the benefits of being a MotionAds Driver"
        class="register-info-img"
      />
    </div>
    <p class="register-byline">
      Please enter your details below to<br />create your driver account
    </p>
    <form
      class="form-card auth-form register-form"
      (submit)="register(); $event.preventDefault()"
    >
      <mat-form-field appearance="outline" class="field">
        <mat-label>First name</mat-label>
        <input matInput [field]="registerForm.firstName" aria-required="true" />
      </mat-form-field>
      <mat-form-field appearance="outline" class="field">
        <mat-label>Last name</mat-label>
        <input matInput [field]="registerForm.lastName" aria-required="true" />
      </mat-form-field>
      <mat-form-field appearance="outline" class="field">
        <mat-label>Phone number</mat-label>
        <input
          matInput
          [field]="registerForm.phone"
          type="tel"
          placeholder=""
          aria-required="true"
        />
      </mat-form-field>
      @let phoneField = registerForm.phone();
      @if (phoneField.touched() && hasError(phoneField.errors(), "required")) {
        <p class="status error">Phone number is required.</p>
      }
      @if (phoneField.touched() && hasError(phoneField.errors(), "pattern")) {
        <p class="status error">Phone must start with 0 and be 10 digits.</p>
      }
      <mat-form-field appearance="outline" class="field">
        <mat-label>Email Address</mat-label>
        <input matInput [field]="registerForm.email" aria-required="true" />
      </mat-form-field>

      <button
        mat-flat-button
        color="primary"
        class="submit"
        type="submit"
        [disabled]="registerForm().invalid()"
      >
        Create driver account
      </button>
      <p class="legal">
        By continuing you agree to our
        <a [routerLink]="termsRoute">Terms of Service</a> and
        <a [routerLink]="privacyRoute">Privacy Policy</a>.
      </p>
      @if (registerMessage()) {
        <p class="status" [class.error]="registerError()">
          {{ registerMessage() }}
        </p>
      }
    </form>
    <div class="register-bottom-cta">
      <p class="have-account">
        Already a Motion Driver?
        <span class="accent">Sign In below.</span>
      </p>
      <button
        mat-flat-button
        color="primary"
        class="bottom-signin"
        type="button"
        (click)="switchMode('login')"
      >
        SIGN IN
      </button>
    </div>
  }
</div>
