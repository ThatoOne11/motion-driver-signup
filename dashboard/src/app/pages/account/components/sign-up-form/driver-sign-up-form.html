<div class="auth-page">
  <app-motion-background></app-motion-background>

  <div class="header">
    <div class="logos">
      <img src="assets/icons/logo.svg" alt="MotionAds" />
      <mat-icon [routerLink]="moreInformationRoute">info</mat-icon>
    </div>
    <h1>Tell Us More About</h1>
    <h2>Your Driving</h2>

    <p>
      Please upload your documents to help your sign up process, but isnt
      required for registration
    </p>
    <div class="step-indicator">Step 1 of 2</div>
  </div>

  <app-driver-progress
    [percent]="progressState().percent"
    [message]="progressState().message"
  ></app-driver-progress>

  <form class="auth-form register-form" (submit)="saveAndContinue($event)">
    @if (submitError(); as err) {
      <div class="error-box">{{ err }}</div>
    }
    <!-- Province first -->
    <mat-form-field appearance="outline" class="field">
      <mat-label>Province</mat-label>
      <mat-select [field]="driverForm.province">
        @for (p of provinces(); track p.id) {
          <mat-option [value]="p.id">
            {{ p.name }}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- City (disabled until province selected) -->
    <mat-form-field appearance="outline" class="field">
      <mat-label>City</mat-label>
      <mat-select [field]="driverForm.city">
        @for (c of cities(); track c.id) {
          <mat-option [value]="c.id">
            {{ c.name }}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- Suburb (switches to input when Province=Other and City=Other) -->
    @if (!isFreeTextSuburb()) {
      <mat-form-field appearance="outline" class="field">
        <mat-label>Suburb</mat-label>
        <mat-select [field]="driverForm.suburb">
          @for (s of suburbs(); track s.id) {
            <mat-option [value]="s.id">
              {{ s.name }}
            </mat-option>
          }
        </mat-select>
      </mat-form-field>
    } @else {
      <mat-form-field appearance="outline" class="field">
        <mat-label>Suburb</mat-label>
        <input
          matInput
          [field]="driverForm.suburb"
          placeholder="Type your suburb"
          type="text"
        />
      </mat-form-field>
    }

    <!-- Platforms -->
    <mat-form-field appearance="outline" class="field">
      <mat-label>Which companies do you drive for?</mat-label>
      <mat-select [field]="driverForm.platforms" multiple>
        @for (p of platforms(); track p.id) {
          <mat-option [value]="p.id">
            {{ p.name }}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- Bike ownership -->
    <mat-form-field appearance="outline" class="field">
      <mat-label>Bike ownership</mat-label>
      <mat-select [field]="driverForm.bikeOwnership">
        @for (b of bikeOwnershipTypes(); track b.id) {
          <mat-option [value]="b.id">
            {{ b.name }}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>

    <!-- Years driving -->
    <mat-form-field appearance="outline" class="field">
      <mat-label>Years driving</mat-label>
      <mat-select [field]="driverForm.yearsDriving">
        @for (y of yearsDrivingOptions(); track y.id) {
          <mat-option [value]="y.id">
            {{ y.label }}
          </mat-option>
        }
      </mat-select>
    </mat-form-field>

    <button
      mat-flat-button
      color="primary"
      class="submit"
      type="submit"
      [disabled]="!driverForm().valid() || driverForm().submitting()"
    >
      @if (!driverForm().submitting()) {
        Save & Continue
      } @else {
        <span class="spinner"></span>
        Saving...
      }
    </button>
  </form>

  <div class="bottom-logout">
    <button type="button" class="logout-pill" (click)="logout()">
      LOG OUT
    </button>
  </div>
</div>
